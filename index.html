<style>
body {
	display: grid;
}
input[type="range"] {
	background: linear-gradient(90deg, #00ff00, #ffff00 75%, #ff0000);
	-webkit-appearance: none;
	margin: 0;
    width: 40vw;
    height: 2vh;
}
input[type=range]::-webkit-slider-runnable-track {
	background: linear-gradient(#00000040, #00000040);
	background-repeat: no-repeat;
	background-size: var(--value);
}
input[type='range']::-webkit-slider-thumb {
	-webkit-appearance: none;
	background: white;
    height: 100%;
    width: .75vw;
	border-radius: 50%;
}
</style>
<script>
HTMLElement.prototype.create = function(tag) {
	return this.appendChild(document.createElement(tag))
}
HTMLElement.prototype.assign = function(source) {
	return Object.assign(this, source)
}
const imgs = {
	closed: localStorage.getItem('closed') || 'https://i.imgur.com/cmFd26w.png',
	opened: localStorage.getItem('opened') || 'https://i.imgur.com/IW4KcWv.png'
}
this.addEventListener('DOMContentLoaded', () => {
	const img = document.body.create('img')
	const input = document.body.create('input').assign({
		type: 'range',
		value: localStorage.getItem('threshold'),
		onchange() {
			localStorage.setItem('threshold', this.value)
		}
	})
	document.body.create('input').assign({
		type: 'file',
		accept: 'image/png',
		onchange() {
			Object.assign(new FileReader(), {
				onload () {
					localStorage.setItem('closed', imgs.closed = this.result)
				}
			}).readAsDataURL(this.files[0])
		}
	})
	document.body.create('input').assign({
		type: 'file',
		accept: 'image/png',
		onchange() {
			Object.assign(new FileReader(), {
				onload () {
					localStorage.setItem('opened', imgs.opened = this.result)
				}
			}).readAsDataURL(this.files[0])
		}
	})
	navigator.mediaDevices.getUserMedia({audio: true}).then(stream => {
		const audio = new AudioContext(), analyser = audio.createAnalyser()
		audio.createMediaStreamSource(stream).connect(analyser)
		const frequencies = new Uint8Array(analyser.frequencyBinCount)
		setInterval(() => {
			const value = Math.floor(analyser.getByteFrequencyData(frequencies) || Math.max(...frequencies) / 255 * 100)
			input.style.setProperty('--value', value + '%')
			img.src = value < input.value ? imgs.closed : imgs.opened
		}, 100)
	})
})
</script>